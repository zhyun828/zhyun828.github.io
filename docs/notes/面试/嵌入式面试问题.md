

# 嵌入式实习面试 50 题｜直接可背版（含追问）

> 使用方法：每题**先背“主回答”**（30–60 秒），再背**1–2 条追问**即可。

---

## A. 存储 / 启动 / 裸机（1–5）

### 1. 什么是 Flash Memory？

**主回答**：Flash Memory（闪存）是 Non-Volatile Memory（非易失性存储器），断电不丢数据；嵌入式中常存 Bootloader、应用程序、参数。常见 NOR Flash（适合代码存储、XIP）和 NAND Flash（容量大、常用于数据）。
**追问**：NOR vs NAND 怎么选？
**追问答**：需要直接执行代码/随机读多→NOR；大容量存储/顺序读写→NAND（通常配文件系统/坏块管理）。

### 2. 什么是 Bootloader？

**主回答**：Bootloader 是上电后执行的第一段程序，负责硬件初始化、选择/加载固件并跳转到应用；常带升级功能（串口/USB/CAN/以太网/OTA）。
**追问**：Bootloader 升级如何防止变砖？
**追问答**：常用双分区 A/B、升级包校验（CRC/签名）、断点续传/回滚、写完再切换启动标志位。

### 3. 什么是裸机编程？

**主回答**：Bare Metal（裸机）是无操作系统，程序直接跑在硬件上；典型结构：主循环 + 中断；优点简单、资源占用小、实时性好。
**追问**：裸机如何组织复杂逻辑？
**追问答**：用有限状态机（FSM）、事件队列、定时器驱动任务切片，把耗时工作放主循环，ISR 只做“置标志/搬数据”。

### 4. GPIO / Timer / PWM 分别做什么？

**主回答**：GPIO（General-Purpose Input/Output）做通用输入输出；Timer 做计数/定时/捕获比较/触发中断；PWM（Pulse Width Modulation）通过占空比输出等效模拟量，用于电机调速、灯光调光等。
**追问**：PWM 频率和分辨率怎么权衡？
**追问答**：频率越高可听噪更小但分辨率可能下降（受定时器时钟与 ARR/PSC 限制）；按负载特性选频率，再尽量提高计数范围提升分辨率。

### 5. 什么是中断控制器（NVIC）？

**主回答**：ARM Cortex-M 常用 NVIC（Nested Vectored Interrupt Controller），负责中断使能、优先级、向量跳转与中断嵌套。
**追问**：中断里能做复杂计算吗？
**追问答**：不建议；ISR 要短小，做“读寄存器/清标志/把数据放缓冲/置事件”，复杂处理放主循环或任务里。

---

## B. 通信协议（6–12）

### 6. 什么是 I2C？

**主回答**：I2C（Inter-Integrated Circuit）是两线同步串行总线：SCL（Serial Clock Line）+ SDA（Serial Data Line），主从架构，通过地址区分设备；常用速率 100 kHz、400 kHz。
**追问**：I2C 为什么要上拉电阻？
**追问答**：I2C 是开漏/开集电极输出，需要外部上拉形成高电平，并支持多设备“线与”共享。
**追问**什么是同步和异步？
**追问答**同步（Synchronous）是指调用方在发起操作后，必须等待操作完成并得到结果，期间会被阻塞；
异步（Asynchronous）是指调用方在发起操作后，不需要等待结果，操作在后台执行，完成后通过回调、事件或通知的方式告知结果。

### 7. USART / UART 是什么？

**主回答**：USART（Universal Synchronous/Asynchronous Receiver Transmitter）可同步也可异步；UART（Universal Asynchronous Receiver/Transmitter）专指异步。常用于点对点串口通信，典型波特率 9600/115200。
**追问**：如何做串口收包不丢数据？
**追问答**：用中断或 DMA + 环形缓冲区，按帧头/长度/校验解析；避免 ISR 里逐字节做重逻辑。

### 8. 什么是 SPI？

**主回答**：SPI（Serial Peripheral Interface）全双工同步通信，常见线：SCLK/MOSI/MISO/CS；速度高、协议简单，适合高速传感器/Flash。
**追问**：SPI 为什么要片选 CS？
**追问答**：总线上可挂多个从设备，CS 用于选择目标从机并界定一次传输的边界。

### 9. 什么是 CAN？

**主回答**：CAN（Controller Area Network）是多主、差分、高可靠总线，通过 Message ID 仲裁，抗干扰强，广泛用于汽车/工业。
**追问**：CAN 标准帧和扩展帧区别？
**追问答**：主要是 ID 位宽：标准帧 11 位 ID，扩展帧 29 位 ID；ID 也参与优先级仲裁（数值越小优先级越高）。

### 10. 什么是 I2S？

**主回答**：I2S（Inter-IC Sound）用于音频数据传输，常见信号：BCLK/LRCLK/SD；连接音频 Codec、DAC/ADC。
**追问**：I2S 数据格式常见有哪些？
**追问答**：Philips I2S、Left-Justified、Right-Justified；差异主要在数据对齐与时钟边沿采样。

### 11. 传感器数据格式、速率怎么描述？

**主回答模板**：说明“协议 + 速率 + 帧结构”：例如 I2C 400 kHz；寄存器读取，原始数据 16 bit/24 bit，按量程与比例换算；若有校验说明 CRC/奇偶校验。
**追问**：如果数据偶尔错怎么办？
**追问答**：加校验（CRC/校验和）、超时重传、滤波/去毛刺；硬件上检查线长、上拉、终端电阻与地参考。

### 12. PWM 的用途？

**主回答**：PWM 通过占空比控制等效功率/电压，常用于电机、LED、蜂鸣器、舵机。
**追问**：舵机 PWM 为什么是 50 Hz？
**追问答**：传统舵机控制脉宽（约 1–2 ms）映射角度，周期通常 20 ms（50 Hz）是行业常用约定。

---

## C. RTOS / 并发（13–20）

### 13. 什么是 RTOS 调度器？

**主回答**：RTOS（Real-Time Operating System）调度器按优先级/就绪状态选择任务运行，支持抢占以满足实时性。
**追问**：抢占式 vs 协作式？
**追问答**：抢占式高优先级可随时打断低优先级；协作式靠任务主动让出 CPU，简单但实时性弱。

### 14. 如何进行实时任务调度和优先级管理？

**主回答**：按业务实时性分级：硬实时高优先级；用互斥锁（Mutex）保护共享资源，用信号量（Semaphore）/消息队列做同步与通信；避免优先级反转。
**追问**：优先级反转怎么解决？
**追问答**：优先级继承（Priority Inheritance）或优先级天花板（Priority Ceiling）。

### 15. 什么是同步和互斥？

**主回答**：同步（Synchronization）协调任务顺序/事件到达；互斥（Mutual Exclusion）保证共享资源同一时刻只被一个任务访问。
**追问**：Mutex 和 Semaphore 区别？
**追问答**：Mutex 用于互斥，通常有“所有权”；Semaphore 适合计数资源或事件通知，不强调所有权。

### 16. 进程和线程通信方式？

**主回答**：IPC（Inter-Process Communication）常见：管道、消息队列、共享内存、Socket；线程间用 mutex、condition variable（条件变量）、semaphore。
**追问**：共享内存为什么快？
**追问答**：避免拷贝，直接共享地址空间，但需额外同步保证一致性。

### 17. 常见调度算法有哪些？

**主回答**：FCFS（First-Come First-Served）、RR（Round Robin）、优先级调度；实时系统常见 FIFO / RR（按优先级队列）。
**追问**：RR 的优缺点？
**追问答**：公平、实现简单；时间片选择不当会导致切换开销大或响应变慢。

### 18. 什么是中断嵌套和中断优先级？

**主回答**：高优先级中断可打断低优先级中断执行；用于保证关键事件优先响应。
**追问**：如何避免中断“打断太多”导致系统不稳？
**追问答**：合理设置优先级、控制 ISR 时长、用 DMA/缓冲、必要时临界区短暂关中断。

### 19. 异常（Exception）和中断（Interrupt）区别？

**主回答**：Interrupt 多由外设/外部事件触发；Exception 多由 CPU 内部事件（Fault、SVC）触发；都会引起控制流切换。
**追问**：HardFault 常见原因？
**追问答**：非法地址访问、栈溢出、未对齐访问、函数指针跑飞等。

### 20. 什么是用户态和内核态？

**主回答**：用户态权限低，不能直接访问硬件；内核态权限高，系统调用从用户态切到内核态完成敏感操作。
**追问**：为什么要区分？
**追问答**：隔离与安全，避免用户程序破坏系统资源。

---

## D. C / C++ 语言（21–35）

### 21. C 和 C++ 的区别？

**主回答**：C 面向过程、贴近硬件；C++ 在此基础上支持面向对象（OOP）、模板等，更利于复杂系统架构与复用。
**追问**：嵌入式更推荐用哪个？
**追问答**：资源紧张/驱动层常用 C；业务复杂/需要抽象复用可用 C++，但要控制异常、RTTI、动态分配等开销。

### 22. 什么是指针？

**主回答**：指针是存放地址的变量；嵌入式中常用于参数传递、数组访问、以及访问 Memory-Mapped Register（内存映射寄存器）。
**追问**：volatile 和寄存器访问关系？
**追问答**：寄存器值可能被硬件改变，需 volatile 防止编译器优化掉读写。

### 23. 引用和指针区别？

**主回答**：引用必须初始化且不可重新绑定；指针可为空、可改指向，但需要手动解引用并注意安全。
**追问**：什么时候更适合引用？
**追问答**：函数参数传递中希望“不为空且语义清晰”时用引用（C++）。

### 24. 什么是结构体（struct）？

**主回答**：用户自定义复合类型，把多个成员组合在一起；常用于描述外设配置、通信帧。
**追问**：结构体对齐（padding）会带来什么？
**追问答**：会插入填充字节导致大小变大；通信/存储时要注意对齐、packed、或手动序列化。

### 25. struct 和 union 区别？

**主回答**：struct 成员独立占内存，总大小累加；union 共用同一块内存，大小取最大成员，只能“同一时刻解释一种类型”。
**追问**：union 常见用途？
**追问答**：节省内存、协议解析（同一段数据按字节/整型解释）。

### 26. 什么是类（class）？

**主回答**：类封装数据与方法，支持封装/继承/多态，提高可维护性与扩展性。
**追问**：class 和 struct 区别？
**追问答**：C++ 中默认访问权限不同：class 默认 private，struct 默认 public。

### 27. C++ 如何实现多态？

**主回答**：通过 virtual function（虚函数）实现运行时多态；基类指针/引用指向派生类对象，调用虚函数触发动态绑定。
**追问**：纯虚函数作用？
**追问答**：定义接口/抽象类，强制派生类实现。

### 28. **补齐：什么是 malloc / free？在嵌入式要注意什么？**

**主回答**：malloc（Memory Allocation）在堆上动态分配内存，free 释放；嵌入式需关注内存碎片、泄漏与实时性抖动。
**追问**：什么时候尽量不用 malloc？
**追问答**：硬实时/长期运行场景尽量用静态/栈/内存池，避免碎片和不可预测延迟。

### 29. 什么是宏定义（macro）？

**主回答**：宏在预处理阶段做文本替换，可用于常量、条件编译；缺点是无类型检查、易引入副作用。
**追问**：宏和 inline 函数怎么选？
**追问答**：有类型/调试友好需求用 inline；简单常量用宏或 const/constexpr。

### 30. 什么是命名空间（namespace）？

**主回答**：namespace 用于组织符号、防止命名冲突，例如 std。
**追问**：为什么不推荐在头文件写 `using namespace std;`？
**追问答**：会污染全局命名空间，导致冲突与二义性。

### 31. 指针和数组区别？

**主回答**：数组是连续内存块、大小固定；指针是地址变量可改指向；sizeof(数组) 得到总大小，sizeof(指针) 是指针大小。
**追问**：函数形参里数组会退化吗？
**追问答**：会退化为指针，因此在函数里 sizeof(arr) 得到的是指针大小。

### 32. 如何判断大端/小端？

**主回答**：看低地址存低字节还是高字节；低地址存低字节是小端；STM32 小端。
**追问**：网络字节序是什么？
**追问答**：通常指大端；跨平台通信需 htonl/ntohl 等转换。

### 33. 手写 strcpy（并说注意点）

**主回答**：

```c
char* my_strcpy(char* dest, const char* src){
    char* ret = dest;
    while((*dest++ = *src++) != '\0');
    return ret;
}
```

注意 dest 空间必须足够、src 必须以 '\0' 结尾；不处理内存重叠（重叠应使用 memmove 思路）。
**追问**：怎么防止溢出？
**追问答**：传入长度，用 strncpy/strlcpy（若可用）或自己做边界检查并保证 '\0' 结尾。

### 34. 递归需要注意什么？

**主回答**：必须有终止条件；每次调用消耗栈；嵌入式栈小，避免深递归。
**追问**：递归能替代吗？
**追问答**：多数可用循环 + 显式栈/队列替代。

### 35. C 文件操作有哪些？

**主回答**：fopen 打开、fread/fwrite 读写、fclose 关闭；嵌入式 Linux 常用于文件/设备节点操作。
**追问**：MCU 裸机也能 fopen 吗？
**追问答**：通常不行，除非有文件系统（FATFS 等）和存储介质支持。

---

## E. MCU / 中断 / 工程（36–43）

### 36. 单片机中断基本流程？

**主回答**：中断触发→保存现场→进入 ISR→处理并清标志→恢复现场返回；用于处理强实时事件。
**追问**：ISR 里最忌讳什么？
**追问答**：长时间阻塞（printf、等待锁、延时），会影响系统实时性。

### 37. 什么是中断向量表？

**主回答**：保存各中断/异常入口地址的表；CPU 根据中断号查表跳转到对应 ISR。
**追问**：向量表能重定位吗？
**追问答**：很多 MCU 支持（如通过 VTOR），用于 Bootloader/APP 分区切换。

### 38. 常见中断类型？

**主回答**：外部中断、定时器中断、串口中断、ADC 中断等。
**追问**：外部中断按键怎么消抖？
**追问答**：中断里只置标志，主循环/定时器延时确认；或用定时器采样滤波。

### 39. 轮询和中断区别？

**主回答**：轮询占 CPU、实时性差；中断事件驱动，效率高、响应快。
**追问**：什么时候反而用轮询？
**追问答**：事件频繁且处理极短、或启动阶段简单读状态、或为避免中断抖动时可用轮询。

### 40. GPIO 基本工作方式？

**主回答**：配置输入/输出模式与上下拉；输入读电平，输出写电平；常用于按键/LED。
**追问**：开漏输出是什么？
**追问答**：只能拉低不能主动拉高，需要上拉电阻，适合总线共享（如 I2C）。

### 41. C 代码和指令的关系？

**主回答**：C 会被编译成机器指令执行；写法影响指令数量、性能与代码大小；嵌入式需关注优化、内联、访存。
**追问**：volatile 会影响什么？
**追问答**：禁止某些优化，保证每次都真实读写内存/寄存器，适用于硬件寄存器与多线程共享变量。

### 42. PID 控制简述？

**主回答**：P 提升响应速度，I 消除稳态误差，D 抑制超调；常用于速度环/位置环。
**追问**：积分饱和怎么处理？
**追问答**：积分限幅、条件积分、输出限幅与反积分（anti-windup）。

### 43. FOC 是什么（被问到就说）？

**主回答**：FOC（Field-Oriented Control）磁场定向控制，把三相电流变换到 d-q 坐标系实现解耦控制，提升效率与动态性能。
**追问**：FOC 里 Clarke/Park 变换目的？
**追问答**：把三相量转换到旋转坐标系，使转矩/励磁分量可分别控制。

---

## F. Linux / 网络（44–50）

### 44. TCP 服务器建立流程？

**主回答**：socket → bind → listen → accept → recv/send → close。
**追问**：accept 是干什么？
**追问答**：从监听 socket 上接收连接请求，返回一个新的已连接 socket 专用于与该客户端通信。

### 45. TCP 和 UDP 区别？

**主回答**：TCP 面向连接、可靠、有流控与拥塞控制；UDP 无连接、开销小、延迟低但不保证可靠。
**追问**：为什么实时更爱 UDP？
**追问答**：丢包可接受但延迟不可接受；UDP 不会因重传/拥塞控制引入额外延迟抖动。

### 46. 进程 vs 线程？

**主回答**：进程是资源分配单位，线程是调度单位；线程共享进程资源，切换开销小但需同步。
**追问**：为什么多进程更“安全”？
**追问答**：地址空间隔离，一个进程崩溃不一定拖垮整个系统（更强隔离）。

### 47. Linux 多线程通信方式？

**主回答**：mutex、semaphore、condition variable、读写锁；通过同步原语保证数据一致性。
**追问**：条件变量适合什么场景？
**追问答**：生产者-消费者，线程等待某个条件成立再继续执行（避免忙等）。

### 48. TCP 为什么三次握手？

**主回答**：确认双方收发能力与初始序列号同步，避免旧连接请求造成错误连接。
**追问**：四次挥手为什么是四次？
**追问答**：TCP 是全双工，双方各自关闭发送方向需要分别确认，因此通常是 FIN/ACK 两轮。

### 49. select / poll / epoll 区别？

**主回答**：select/poll 轮询扫描，连接多效率下降；epoll 事件驱动，适合高并发。
**追问**：为什么 epoll 更适合高并发？
**追问答**：把“就绪事件”从内核推送出来，避免每次遍历全部 fd；并能复用就绪列表。

### 50. 嵌入式 Linux 是什么？

**主回答**：裁剪后的 Linux 运行在嵌入式设备上，功能强（网络、多进程、驱动生态）但资源占用更大、实时性相对弱（可配 PREEMPT_RT 或用 RT 方案补齐）。
**追问**：什么时候选嵌入式 Linux 而不是 MCU？
**追问答**：需要复杂网络/多媒体/文件系统/高算力/丰富外设生态时选 Linux；硬实时、低功耗、成本敏感多选 MCU/RTOS。




---

# 三、Linux / OS / 网络（区分初级 & 进阶｜可背版）

## 1️⃣ 用过操作系统吗？（RTOS 加分项）

**面试官问法**

> 你用过哪些操作系统？FreeRTOS / uC/OS / Linux 了解多少？

**标准回答（直接背）**

> 用过 FreeRTOS（或 uC/OS），理解任务（Task）、调度（Scheduler）、优先级（Priority）以及同步机制：互斥锁（Mutex）、信号量（Semaphore）、消息队列（Queue）。
> 在 STM32 项目中用 RTOS 把通信、传感器采集、控制算法分成不同任务，提高系统实时性与可维护性。

**追问 1：RTOS 和裸机的区别？**
**追问答**：

> 裸机通常是 while(1)+中断，结构简单但复杂度上升后不好维护；RTOS 支持多任务与同步机制，结构清晰、扩展方便，但占用资源更多。

**追问 2：什么是优先级反转？怎么解决？**
**追问答**：

> 低优先级任务持有锁，高优先级任务等待，中优先级任务又一直运行导致高优先级被“卡住”，这叫优先级反转。
> 常用优先级继承（Priority Inheritance）解决。

---

## 2️⃣ 进程 vs 线程？

**面试官问法**

> 进程和线程有什么区别？为什么线程切换更快？

**标准回答**

> 进程是资源分配的基本单位，线程是 CPU 调度的基本单位。
> 同一进程内线程共享地址空间与资源，创建/切换开销更小；进程之间隔离更强但开销更大。

**追问 1：多进程更安全吗？为什么？**
**追问答**：

> 进程地址空间隔离，一个进程崩溃不一定影响其他进程；线程共享内存，出错可能拖垮整个进程。

**追问 2：线程同步常用什么？**
**追问答**：

> 互斥锁（Mutex）、读写锁、条件变量（Condition Variable）、信号量（Semaphore）。

---

## 3️⃣ TCP 和 UDP 区别？

**面试官问法**

> TCP 和 UDP 区别？什么时候用 UDP？

**标准回答**

> TCP（Transmission Control Protocol，传输控制协议）面向连接、可靠传输，有重传、流量控制和拥塞控制；
> UDP（User Datagram Protocol，用户数据报协议）无连接，开销小、延迟低，但不保证可靠。
> 实时音视频、传感器流数据等对延迟敏感场景更倾向 UDP。

**追问 1：TCP 为什么可靠？**
**追问答**：

> 有序号、确认应答 ACK、超时重传、滑动窗口，以及拥塞控制保证链路不过载。

**追问 2：UDP 不可靠怎么补救？**
**追问答**：

> 应用层加序号+校验（CRC/校验和）+丢包检测+必要时重传，或做前向纠错（FEC）。

---

## 4️⃣ TCP 建立服务器流程？

**面试官问法**

> Linux 下用 TCP 写服务器，流程说一下。

**标准回答（经典五步）**

1. `socket()`：创建套接字
2. `bind()`：绑定 IP+端口
3. `listen()`：进入监听状态
4. `accept()`：接受客户端连接（返回新的连接 socket）
5. `recv()/send()`：收发数据，结束后 `close()`

**追问 1：listen 和 accept 的区别？**
**追问答**：

> listen 是把 socket 变成“监听 socket”；accept 是从监听队列里取出一个连接，生成一个“已连接 socket”专门和该客户端通信。

**追问 2：为什么 accept 返回一个新的 socket？**
**追问答**：

> 原来的监听 socket 要继续接新连接；新的 socket 用于和某个客户端收发数据，互不干扰。

**追问 3：并发服务器怎么做？**
**追问答**：

> 常见：多进程/多线程、线程池；或 I/O 多路复用（select/poll/epoll）做高并发。

---

可以。我下面给你一段**可直接粘进 md**的补充内容：继续沿用你这一章的编号（你现在到 **4️⃣ TCP 建立服务器流程**），我把后续常见高频题按 **5️⃣、6️⃣…** 往下排，且每题都有**主答 + 追问答**。

> 你把这段直接接在 “4️⃣ TCP 建立服务器流程” 后面即可。

---

## 5️⃣ TCP 为什么三次握手？四次挥手？

**标准回答（背这个）**

> 三次握手是为了确认双方收发能力正常，并同步初始序列号，避免旧连接请求造成错误连接。
> 四次挥手因为 TCP 是全双工连接，双方关闭发送方向需要分别发送 FIN 并确认 ACK，所以通常是四次。

**追问：TIME_WAIT 是什么？为什么要等？**

> TIME_WAIT 用于等待 2MSL，确保最后 ACK 能到达对方，同时让网络中的旧报文过期，避免影响新连接。

---

## 6️⃣ TCP 粘包/拆包是什么？怎么处理？

**标准回答**

> TCP 是“字节流”协议，没有消息边界，发送端多次 send 到接收端可能被合并或拆分，导致粘包/拆包。
> 处理方式是在应用层定义协议边界：
>
> * 固定长度
> * 分隔符
> * **长度字段（推荐：Header + Length + Payload + CRC）**

**追问：为什么 UDP 不粘包？**

> UDP 是数据报，天然保留报文边界；但可能丢包、乱序、重复。

---

## 7️⃣ 网络字节序是什么？htons / htonl / ntohs / ntohl 做什么？

**标准回答**

> 网络字节序通常是大端（Big Endian）。不同 CPU 可能大小端不同，跨平台传输要统一字节序。
> `htons/htonl`：主机序 → 网络序（16/32 位）
> `ntohs/ntohl`：网络序 → 主机序

**追问：STM32 是大端还是小端？**

> STM32（ARM Cortex-M）一般是小端（Little Endian）。

---

## 8️⃣ select / poll / epoll 的区别？

**标准回答**

> select/poll 每次都要扫描 fd 集合，连接数多效率下降；
> epoll 是事件驱动，把 fd 注册到内核，就绪时返回事件列表，适合高并发。

**追问：epoll 的 LT 和 ET？**

> LT（水平触发）：还有数据就持续通知，易用；
> ET（边沿触发）：状态变化才通知，效率高但必须非阻塞并一次读空/写尽。

---

## 9️⃣ 阻塞 I/O 和非阻塞 I/O 区别？怎么设置非阻塞？

**标准回答**

> 阻塞：调用 recv/send/connect 可能一直等到条件满足；
> 非阻塞：立刻返回，没数据就返回 EAGAIN/EWOULDBLOCK。
> Linux 下可用 `fcntl(fd, F_SETFL, O_NONBLOCK)` 设置。

**追问：非阻塞 + epoll 常见模型是什么？**

> Reactor 模型：事件驱动，读写回调里处理，配合缓冲区管理。

---

## 🔟 UDP 建立服务器流程？

**标准回答**

> UDP 服务器一般：`socket → bind → recvfrom/sendto → close`
> 不需要 listen/accept，因为无连接。

**追问：UDP 怎么保证可靠？**

> 应用层加序号、ACK、重传、超时、滑动窗口，或 FEC。

---

## 1️⃣1️⃣ TCP 连接断开/异常你怎么检测？

**标准回答**

> recv 返回 0 表示对端正常关闭；返回 -1 结合 errno 判断异常；
> 还可以设置 keepalive 或应用层心跳检测。

**追问：心跳包怎么设计？**

> 定期发小包 + 超时计数；超过 N 次未收到则判定断开并重连。

---

## 1️⃣2️⃣ 进程和线程的区别？（再强调一次，面试超高频）

**标准回答**

> 进程是资源分配单位，线程是调度单位；线程共享进程资源，切换开销小，但更需要同步。

**追问：线程同步用哪些？**

> mutex、semaphore、condition variable、读写锁；避免数据竞争。

---

## 1️⃣3️⃣ 死锁是什么？怎么避免？

**标准回答**

> 死锁是多个线程互相等待资源导致永远阻塞。
> 避免方式：固定加锁顺序、减少锁持有时间、尝试锁 trylock、超时机制、拆分锁粒度。

**追问：死锁四个必要条件？**

> 互斥、占有且等待、不可剥夺、循环等待（破坏任意一个即可）。

---

## 1️⃣4️⃣ Linux 下如何排查程序卡死/高 CPU？

**标准回答**

> 先用 top/htop 看 CPU/线程；ps 查进程；
> strace 看系统调用是否阻塞；gdb attach 看堆栈；
> 若多线程，结合 `pstack`/gdb 的 `thread apply all bt` 查看所有线程栈。

**追问：如何定位内存泄漏？**

> valgrind（Linux 用户态）、或用 sanitizer（ASan/LSan），嵌入式侧更常用日志+内存池统计。

---

## 1️⃣5️⃣ 用户态和内核态的区别？系统调用是什么？

**标准回答**

> 用户态权限低不能直接访问硬件；内核态权限高管理进程/内存/设备；
> 系统调用是用户程序请求内核服务的入口，会触发态切换。

**追问：为什么要分两态？**

> 安全与隔离，防止应用程序破坏系统稳定性。

---

## 1️⃣6️⃣ Linux 常见命令（嵌入式实习常被顺口问）

**标准回答（按用途背）**

> 进程：ps/top/kill
> 网络：ping/ip/ss/tcpdump
> 文件：ls/cd/cp/mv/rm/grep/find
> 权限：chmod/chown
> 日志：dmesg/journalctl（视系统而定）

**追问：怎么看某端口是否被占用？**

> `ss -lntp`（或 `netstat -lntp`）。

---

## 1️⃣7️⃣ 你如何描述自己项目里的“通信协议细节”？（面试必杀模板）

**标准回答模板**

> 我会从四点说：
> 1）协议：SPI/I2C/UART/CAN
> 2）速率：如 I2C 400kHz、SPI 8MHz、UART 115200、CAN 500kbps
> 3）帧格式：帧头/长度/负载/校验（CRC）
> 4）可靠性：超时、重传、环形缓冲、DMA、中断策略

**追问：你一般把什么放 ISR，什么放主循环/任务？**

> ISR 只做“快速搬运+置标志”，解析/计算放任务；配合 DMA+ring buffer 提升稳定性。
